**Replit prompt – auto-playlist aanmaken & koppelen bij gekoppeld scherm (Yodeck), zodat proposals niet blokkeren**

Probleem:

* Scherm is gekoppeld (Yodeck player bestaat)
* Proposal preview faalt met: “Geen schermen met gekoppelde playlist”
* Er is nog geen geschikte advertentie-playlist aan dit scherm gekoppeld

Doel:
Zodra een scherm gekoppeld is aan Yodeck, moet er **automatisch** een geldige advertentie-playlist bestaan en gekoppeld zijn, zodat proposals altijd werken.

---

## A) Definitie: wat is een geldige advertentie-playlist

Een playlist is “ad-geschikt” als:

* type/category = `ad` of `mixed`
* gekoppeld aan exact 1 scherm of locatie
* capaciteit bekend is (loopDurationSeconds / adSlotCapacitySeconds)

Leg dit vast in code (helper `isSellablePlaylist(playlist)`).

---

## B) Auto-playlist provisioning (belangrijkste stap)

Bij events:

* screen gekoppeld aan Yodeck
* of bij eerste proposal attempt
* of bij sync job

Voer dit uit:

1. Check of er al een ad-geschikte playlist bestaat voor dit scherm
2. Zo niet:

   * maak via Yodeck API een playlist aan
   * naam: `${LocationName} (auto-playlist-${screenId}-fit)`
   * type: `mixed` of `ad`
3. Koppel playlist aan screen in Yodeck
4. Sla mapping op in DB:

   * `screenId`
   * `playlistId`
   * `playlistType = 'ad'`
   * `isAutoGenerated = true`

Log dit als audit event: `PLAYLIST_AUTO_CREATED`.

---

## C) Placement engine fallback

In proposal generatie:

* Als geen sellable playlist gevonden:

  * probeer auto-playlist provisioning
  * herhaal proposal berekening
* Alleen als dit ook faalt → toon waarschuwing “geen playlists”

**Belangrijk:** proposal mag niet falen zolang scherm bestaat en auto-playlist aanmaken lukt.

---

## D) UI-tekst aanpassen (klein maar belangrijk)

Vervang:

> “Koppel playlists aan locaties in Yodeck”

Door:

> “We hebben nog geen advertentie-playlist gevonden. Deze wordt automatisch aangemaakt zodra het scherm klaar is.”

(alleen tonen als auto-create faalt)

---

## Acceptatiecriteria

* Gekoppeld scherm zonder playlist → auto-playlist wordt aangemaakt
* Proposal preview toont daarna 1+ voorgestelde schermen
* Admin hoeft niets handmatig in Yodeck te doen
* “Geen schermen met gekoppelde playlist” verschijnt alleen bij echte fouten
